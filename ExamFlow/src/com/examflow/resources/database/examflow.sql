DROP TABLE IF EXISTS enseignant;
DROP TABLE IF EXISTS etudiant;
DROP TABLE IF EXISTS examen;
DROP TABLE IF EXISTS qcm;
DROP TABLE IF EXISTS reponse;
DROP TABLE IF EXISTS resultat;


CREATE TABLE enseignant (
id INT PRIMARY KEY AUTO_INCREMENT NOT NULL,
nom VARCHAR(200) NOT NULL,
email VARCHAR(100) NOT NULL,
mdp VARCHAR(100) NOT NULL,
date_inscription DATETIME NOT NULL);

CREATE TABLE etudiant (
id INT PRIMARY KEY AUTO_INCREMENT NOT NULL,
nom VARCHAR(200) NOT NULL,
email VARCHAR(100) NOT NULL,
mdp VARCHAR(50) NOT NULL,
date_inscription DATETIME NOT NULL);

CREATE TABLE examen (
id INT PRIMARY KEY AUTO_INCREMENT NOT NULL,
code CHAR(5) NOT NULL,
theme VARCHAR(100) NOT NULL,
debut DATETIME NOT NULL,
fin DATETIME NOT NULL,
instruction TEXT NOT NULL,
id_enseignant INT NOT NULL);

CREATE TABLE qcm (
id INT PRIMARY KEY AUTO_INCREMENT NOT NULL,
id_examen INT NOT NULL,
question VARCHAR(200) NOT NULL,
rebours_sec INT NOT NULL);

CREATE TABLE reponse (
id INT PRIMARY KEY AUTO_INCREMENT NOT NULL,
id_qcm INT NOT NULL,
intitule TEXT NOT NULL,
est_bonne BOOLEAN NOT NULL,
point_unitaire DOUBLE NOT NULL);

CREATE TABLE resultat (
id INT PRIMARY KEY AUTO_INCREMENT NOT NULL,
id_examen INT NOT NULL,
id_etudiant INT NOT NULL,
note DOUBLE NOT NULL);

ALTER TABLE examen ADD CONSTRAINT examen_id_enseignant_enseignant_id FOREIGN KEY (id_enseignant) REFERENCES enseignant(id) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE qcm ADD CONSTRAINT qcm_id_examen_examen_id FOREIGN KEY (id_examen) REFERENCES examen(id) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE reponse ADD CONSTRAINT reponse_id_qcm_qcm_id FOREIGN KEY (id_qcm) REFERENCES qcm(id) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE resultat ADD CONSTRAINT resultat_id_examen_examen_id FOREIGN KEY (id_examen) REFERENCES examen(id) ON DELETE CASCADE ON UPDATE CASCADE;
ALTER TABLE resultat ADD CONSTRAINT resultat_id_etudiant_etudiant_id FOREIGN KEY (id_etudiant) REFERENCES etudiant(id) ON DELETE CASCADE ON UPDATE CASCADE;
